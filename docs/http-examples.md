# HTTP API â€“ Examples

This document contains example HTTP requests and responses for the current API endpoints.

## Base URL
```bash
http://127.0.0.1:3000
```

---

## POST /inventory/update

Updates the inventory of a household by adding or consuming ingredients.

### Request (PowerShell)
```bash
$body = @{
  householdId = "550e8400-e29b-41d4-a716-446655440000"
  operations = @(
    @{
      type="ADD"
      ingredientId="550e8400-e29b-41d4-a716-446655440000"
      amount=2
      expirationDate="2026-02-05"
    }
  )
} | ConvertTo-Json -Depth 5

Invoke-RestMethod -Method Post -Uri http://127.0.0.1:3000/inventory/update -ContentType "application/json" -Body $body
```

## Response (200 OK)
```json
{
  "householdId": "550e8400-e29b-41d4-a716-446655440000",
  "items": [
    {
      "ingredientId": "550e8400-e29b-41d4-a716-446655440000",
      "quantity": 2,
      "expirationDate": "2026-02-05"
    }
  ]
}
```

## Notes
- Request is validated using shared contracts (packages/contracts)
- Inventory is stored in-memory (no persistence yet)

---

## POST /suggestions/generate

Generates a daily meal suggestion based on current inventory and available recipes.

### Request (PowerShell)

```bash
$body = @{
  householdId = "550e8400-e29b-41d4-a716-446655440000"
  date = "2026-02-03"
  slot = "CENA"
  maxSuggestions = 3
  expiringDaysThreshold = 3
} | ConvertTo-Json -Depth 5

Invoke-RestMethod `
  -Method Post `
  -Uri http://127.0.0.1:3000/suggestions/generate `
  -ContentType "application/json" `
  -Body $body
```

## Response (200 OK)
```json
{
  "householdId": "550e8400-e29b-41d4-a716-446655440000",
  "date": "2026-02-03",
  "slot": "CENA",
  "status": "PROPUESTA",
  "recipes": [
    { "recipeId": "r3", "name": "Milk & Cereal" },
    { "recipeId": "r2", "name": "Rice Bowl" }
  ],
  "reasoning": {
    "usedExpiringIngredients": ["milk"],
    "totalCandidateRecipes": 3
  }
}
```

## Notes
- Uses GenerateDailySuggestionUseCase (rules-based)
- Prioritizes recipes that use ingredients expiring soon
- Uses in-memory inventory + in-memory recipes (no DB yet)

---

## POST /shopping-list/generate

Generates a shopping list based on the current inventory and the ingredients required by one or more recipes.

### Important note about IDs

All identifiers used by this endpoint are **validated as UUIDs** at runtime using shared contracts (Zod):

- `householdId`
- `recipeId`
- `ingredientId`

When testing this endpoint, make sure to use **valid UUID strings**.  
Using non-UUID values (e.g. `"rice"`, `"r1"`, `"eggs"`) will result in a `400 Invalid request` response, which is the expected behavior.

---

### Request (PowerShell)

```bash
$body = @{
  householdId = "550e8400-e29b-41d4-a716-446655440000"
  recipes = @(
    @{
      recipeId = "11111111-1111-1111-1111-111111111111"
      ingredients = @(
        @{
          ingredientId = "22222222-2222-2222-2222-222222222222"
          amount = 2
        },
        @{
          ingredientId = "33333333-3333-3333-3333-333333333333"
          amount = 2
        }
      )
    }
  )
} | ConvertTo-Json -Depth 10

Invoke-RestMethod `
  -Method Post `
  -Uri http://127.0.0.1:3000/shopping-list/generate `
  -ContentType "application/json" `
  -Body $body
```

## Response (200 OK)
```json
{
  "householdId": "550e8400-e29b-41d4-a716-446655440000",
  "items": [
    {
      "ingredientId": "22222222-2222-2222-2222-222222222222",
      "missingAmount": 1
    },
    {
      "ingredientId": "33333333-3333-3333-3333-333333333333",
      "missingAmount": 2
    }
  ]
}
```


## Notes
- The shopping list is generated by comparing required ingredients against the current inventory.
- Only missing or insufficient ingredients are included in the result.
- Inventory data is stored in-memory in the current MVP iteration.